import { ref, computed } from 'vue'

export type Locale = 'zh' | 'en'

const messages: Record<Locale, Record<string, string>> = {
  zh: {
    warning_wallet_not_installed: '请先安装Turing钱包',
    app_title: '存钱罐',
    nav_details: '存储明细',
    back: '返回',
    click_get_address: '点击获取地址',
    deposit_section: '存入资产',
    current_address: '当前钱包地址',
    current_balance: '当前钱包余额(TBC)',
    current_height: '当前区块高度',
    amount_label: '金额 (TBC)',
    input_amount_placeholder: '请输入存入金额',
    submit_deposit: '存入',
    time_term: '存储期限',
    please_select_term: '请选择存储期限',
    due_date: '到期日期约',
    due_height: '到期区块高度约',
    details_title: '存储明细',
    stats_frozen_total: '存储中资产总额 (TBC)',
    stats_unfrozen_total: '存储到期可提取资产总额 (TBC)',
    list_unfrozen_title: '存储到期可提取资产',
    list_unfrozen_empty: '暂无可提取资产',
    list_frozen_title: '存储中资产',
    list_frozen_empty: '暂无已存储资产',
    amount_tbc: 'TBC',
    withdraw: '提取',
    extracting: '提取',
    loading: '数据加载中...',
    need_wallet_install: '请先安装Turing钱包',
    err_get_address: '获取钱包地址失败',
    err_get_balance: '获取钱包余额失败',
    err_get_height: '获取当前区块高度失败',
    err_load_assets: '加载资产失败',
    withdraw_success: '提取成功！',
    withdraw_failed: '提取失败！请检查网络连接或重试。',
    deposit_success: '存入成功！',
    deposit_failed: '存入失败！请检查网络连接或重试。',
    tip_storage_term: '存储期限以区块高度为准',
    // form errors
    err_enter_amount: '请输入存入金额',
    err_amount_format: '请输入正小数且最多精确到小数点后6位',
    err_amount_exceed_balance: '存入金额不能大于钱包余额',
    err_select_time: '请选择存入时间',
    err_invalid_time: '请选择有效的存入时间',
    // terms
    term_1d: '1天',
    term_1w: '1周',
    term_1m: '1个月',
    term_3m: '3个月',
    term_6m: '6个月',
    term_1y: '1年',
    term_2y: '2年',
    term_3y: '3年',
    term_5y: '5年',
    term_10y: '10年',
    term_20y: '20年',
    // infos
    info_storage_term: '存储到期时间',
    info_block_height: '区块高度',
    decode_error: '解码错误',
    not_matured: '未到期',
    already_matured: '已到期',
    // guide
    guide_title: '存钱罐网站使用说明',
    guide_tagline: '存储你的钱！',
    guide_section_flow: '一、操作流程',
    guide_how_deposit: '1. 如何存入资产',
    guide_home_info: '进入 “存钱罐” 主页，可查看当前钱包地址、钱包余额（TBC）及区块高度。',
    guide_click_get_address: '点击 “点击获取地址” 按钮，可刷新 / 获取钱包地址（用于接收 TBC）。',
    guide_deposit_steps_title: '存入步骤：',
    guide_step1_amount: '① 在 “存入资产” 区域，输入要存入的金额（TBC）；',
    guide_step2_term: '② 点击 “请选择存储期限” 下拉框，选择存储时长（期限以区块高度为准）；',
    guide_step3_submit: '③ 点击 “存入” 按钮完成操作。',
    guide_how_withdraw: '2. 如何提取资产',
    guide_withdraw_nav: '在主页右上角点击 “存储明细”，进入明细页面可查看存储资产详情。',
    guide_withdraw_pick: '查看可提取资产，选中一笔资产点击 “提取” 按钮即可提取。',
    guide_section_notice: '二、注意事项',
    guide_notice_wallet: '在使用本站功能前，需要安装 Turing Wallet。',
    guide_notice_term: '存储期限以区块高度为准，到期时间与区块高度对应。',
    guide_notice_maturity: '未到期资产无法提取，需等待至到期后操作。',
    guide_notice_refresh: '钱包地址、余额及区块高度会实时更新，可通过 “点击获取地址” 刷新信息。',
    guide_toggle_label: '查看更详细的使用说明',
  },
  en: {
    warning_wallet_not_installed: 'Please install Turing Wallet first',
    app_title: 'Piggy Bank',
    nav_details: 'Deposit Details',
    back: 'Back',
    click_get_address: 'Click to get address',
    deposit_section: 'Deposit',
    current_address: 'Wallet Address',
    current_balance: 'Wallet Balance (TBC)',
    current_height: 'Current Block Height',
    amount_label: 'Amount (TBC)',
    input_amount_placeholder: 'Enter deposit amount',
    submit_deposit: 'Deposit',
    time_term: 'Deposit Term',
    please_select_term: 'Select a deposit term',
    due_date: 'Maturity Date About',
    due_height: 'Maturity Block Height About',
    details_title: 'Deposit Details',
    stats_frozen_total: 'Total Deposited (TBC)',
    stats_unfrozen_total: 'Total Withdrawable (TBC)',
    list_unfrozen_title: 'Withdrawable Assets',
    list_unfrozen_empty: 'No deposited assets',
    list_frozen_title: 'Deposited Assets',
    list_frozen_empty: 'No deposited assets',
    amount_tbc: 'TBC',
    withdraw: 'Withdraw',
    extracting: 'Withdraw',
    loading: 'Loading...',
    need_wallet_install: 'Please install Turing Wallet first',
    err_get_address: 'Failed to get wallet address',
    err_get_balance: 'Failed to get wallet balance',
    err_get_height: 'Failed to get current block height',
    err_load_assets: 'Failed to load assets',
    withdraw_success: 'Withdrawal successful!',
    withdraw_failed: 'Withdrawal failed! Please check your network and try again.',
    deposit_success: 'Deposit successful!',
    deposit_failed: 'Deposit failed! Please check your network and try again.',
    tip_storage_term: 'Deposit term is based on block height',
    // form errors
    err_enter_amount: 'Please enter the deposit amount',
    err_amount_format: 'Please enter a positive number with up to 6 decimals',
    err_amount_exceed_balance: 'Amount cannot exceed wallet balance',
    err_select_time: 'Please select a deposit term',
    err_invalid_time: 'Please select a valid deposit term',
    // terms
    term_1d: '1 Day',
    term_1w: '1 Week',
    term_1m: '1 Month',
    term_3m: '3 Months',
    term_6m: '6 Months',
    term_1y: '1 Year',
    term_2y: '2 Years',
    term_3y: '3 Years',
    term_5y: '5 Years',
    term_10y: '10 Years',
    term_20y: '20 Years',
    // infos
    info_storage_term: 'Deposit Term',
    info_block_height: 'Block Height',
    decode_error: 'Decode Error',
    not_matured: 'Not Matured',
    already_matured: 'Already Matured',
    // guide
    guide_title: 'Piggy Bank User Guide',
    guide_tagline: 'Store your money!',
    guide_section_flow: '1) How it works',
    guide_how_deposit: '1. How to deposit',
    guide_home_info: 'On the Home page you can view your wallet address, balance (TBC), and block height.',
    guide_click_get_address: 'Click “Click to get address” to refresh/get an address (for receiving TBC).',
    guide_deposit_steps_title: 'Deposit steps:',
    guide_step1_amount: '① Enter the amount (TBC) in the “Deposit” section;',
    guide_step2_term: '② Choose a term from the “Select deposit term” dropdown (term is based on block height);',
    guide_step3_submit: '③ Click “Deposit” to submit.',
    guide_how_withdraw: '2. How to withdraw',
    guide_withdraw_nav: 'Click “Deposit Details” in the top-right to view your deposits.',
    guide_withdraw_pick: 'Find a withdrawable item and click “Withdraw”.',
    guide_section_notice: '2) Notes',
    guide_notice_wallet: 'Install Turing Wallet before using this site.',
    guide_notice_term: 'Deposit term is based on block height; maturity time corresponds to height.',
    guide_notice_maturity: 'Assets cannot be withdrawn before maturity.',
    guide_notice_refresh: 'Address, balance, and height update in real time; use “Click to get address” to refresh.',
    guide_toggle_label: 'View detailed user guide',
  },
}

const stored = (localStorage.getItem('locale') as Locale) || 'zh'
export const locale = ref<Locale>(stored)

export function setLocale(l: Locale) {
  locale.value = l
  localStorage.setItem('locale', l)
}

export function t(key: string): string {
  const map = messages[locale.value]
  return map[key] ?? key
}

export const currentLocaleLabel = computed(() => (locale.value === 'zh' ? '中文' : 'English'))


